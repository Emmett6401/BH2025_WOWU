<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, user-scalable=yes">
    <meta name="description" content="êµìœ¡ ê¸°ê´€ì˜ ê°•ì‚¬, í•™ìƒ, ìƒë‹´, í›ˆë ¨ì¼ì§€ë¥¼ í†µí•© ê´€ë¦¬í•˜ëŠ” ìŠ¤ë§ˆíŠ¸ êµìœ¡ê´€ë¦¬ í”Œë«í¼">
    <meta name="theme-color" content="#3B82F6">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="default">
    <meta name="apple-mobile-web-app-title" content="BH2025">
    
    <title>ë°”ì´ì˜¤í—¬ìŠ¤êµìœ¡ê´€ë¦¬ì‹œìŠ¤í…œ</title>
    
    <!-- PWA Manifest -->
    <link rel="manifest" href="/manifest.json">
    
    <!-- Favicon and Icons -->
    <link rel="icon" type="image/x-icon" href="/favicon.ico">
    <link rel="apple-touch-icon" sizes="72x72" href="/icon-72x72.png">
    <link rel="apple-touch-icon" sizes="96x96" href="/icon-96x96.png">
    <link rel="apple-touch-icon" sizes="128x128" href="/icon-128x128.png">
    <link rel="apple-touch-icon" sizes="144x144" href="/icon-144x144.png">
    <link rel="apple-touch-icon" sizes="152x152" href="/icon-152x152.png">
    <link rel="apple-touch-icon" sizes="192x192" href="/icon-192x192.png">
    
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.4.0/css/all.min.css" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>
    
    <!-- ë§ˆí¬ë‹¤ìš´ ë Œë”ë§ ë¼ì´ë¸ŒëŸ¬ë¦¬ -->
    <script src="https://cdn.jsdelivr.net/npm/marked@11.1.0/marked.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/dompurify@3.0.6/dist/purify.min.js"></script>
    
    <link href="/pwa-styles.css" rel="stylesheet">
    
    <style>
        /* ë§ˆí¬ë‹¤ìš´ ë¯¸ë¦¬ë³´ê¸° ìŠ¤íƒ€ì¼ */
        .prose {
            max-width: none;
        }
        .prose h1 { font-size: 2em; font-weight: bold; margin-top: 0.5em; margin-bottom: 0.5em; }
        .prose h2 { font-size: 1.5em; font-weight: bold; margin-top: 0.5em; margin-bottom: 0.5em; }
        .prose h3 { font-size: 1.25em; font-weight: bold; margin-top: 0.5em; margin-bottom: 0.5em; }
        .prose p { margin-top: 0.5em; margin-bottom: 0.5em; line-height: 1.6; }
        .prose ul, .prose ol { margin-left: 1.5em; margin-top: 0.5em; margin-bottom: 0.5em; }
        .prose li { margin-top: 0.25em; margin-bottom: 0.25em; }
        .prose a { color: #3b82f6; text-decoration: underline; }
        .prose a:hover { color: #2563eb; }
        .prose code { background-color: #f3f4f6; padding: 0.2em 0.4em; border-radius: 0.25rem; font-size: 0.9em; }
        .prose pre { background-color: #1f2937; color: #f3f4f6; padding: 1em; border-radius: 0.5rem; overflow-x: auto; margin-top: 0.5em; margin-bottom: 0.5em; }
        .prose pre code { background-color: transparent; padding: 0; color: inherit; }
        .prose blockquote { border-left: 4px solid #d1d5db; padding-left: 1em; color: #6b7280; margin-top: 0.5em; margin-bottom: 0.5em; }
        .prose strong { font-weight: bold; }
        .prose em { font-style: italic; }
        .prose hr { border-top: 1px solid #e5e7eb; margin-top: 1em; margin-bottom: 1em; }
        .line-clamp-2 {
            display: -webkit-box;
            -webkit-line-clamp: 2;
            -webkit-box-orient: vertical;
            overflow: hidden;
        }
    </style>
    
    <!-- ë¡œê·¸ì¸ ì²´í¬ (ì¦‰ì‹œ ì‹¤í–‰) - sessionStorage ì‚¬ìš© (ë¸Œë¼ìš°ì € ë‹«ìœ¼ë©´ ì„¸ì…˜ ì‚­ì œ) -->
    <script>
        (function() {
            console.log('ğŸ”’ ì¦‰ì‹œ ë¡œê·¸ì¸ ì²´í¬ ì‹¤í–‰');
            const loggedIn = sessionStorage.getItem('logged_in');
            const instructor = sessionStorage.getItem('instructor');
            
            // ë¡œê·¸ì¸ ì •ë³´ê°€ ì—†ìœ¼ë©´ ì¦‰ì‹œ ë¡œê·¸ì¸ í˜ì´ì§€ë¡œ ë¦¬ë‹¤ì´ë ‰íŠ¸
            if (!loggedIn || loggedIn !== 'true' || !instructor) {
                console.log('âŒ ë¡œê·¸ì¸ ì•ˆ ë¨ - ë¡œê·¸ì¸ í˜ì´ì§€ë¡œ ì¦‰ì‹œ ë¦¬ë‹¤ì´ë ‰íŠ¸');
                window.location.replace('/login.html');
                // í˜ì´ì§€ ë¡œë”© ì¤‘ë‹¨
                document.addEventListener('DOMContentLoaded', function(e) {
                    e.stopImmediatePropagation();
                }, true);
            } else {
                console.log('âœ… ë¡œê·¸ì¸ í™•ì¸ë¨ - í˜ì´ì§€ ë¡œë“œ ê³„ì†');
            }
        })();
    </script>
</head>
<body class="bg-gray-50">
    <div class="min-h-screen">
        <!-- í—¤ë” -->
        <header class="bg-blue-600 text-white shadow-lg">
            <div class="container mx-auto px-4 py-6">
                <div class="flex justify-between items-start">
                    <div class="flex items-center gap-4">
                        <div class="bg-white rounded-lg px-3 py-2 flex items-center justify-center shadow-md" style="height: 80px;">
                            <img src="/woosong-logo.png" alt="ìš°ì†¡ëŒ€í•™êµ ë¡œê³ " class="h-full w-auto object-contain">
                        </div>
                        <div>
                            <h1 id="system-title-header" class="text-3xl font-bold flex items-center">
                                <i class="fas fa-school mr-3"></i>
                                ë°”ì´ì˜¤í—¬ìŠ¤êµìœ¡ê´€ë¦¬ì‹œìŠ¤í…œ
                            </h1>
                            <p id="system-subtitle1-header" class="text-blue-100 mt-1">ë³´ê±´ë³µì§€ë¶€(í•œêµ­ë³´ê±´ì‚°ì—…ì§„í¥ì›), KDT, ìš°ì†¡ëŒ€í•™êµì‚°í•™í˜‘ë ¥ë‹¨</p>
                            <p id="system-subtitle2-header" class="text-blue-100">ë°”ì´ì˜¤í—¬ìŠ¤ì•„ì¹´ë°ë¯¸ ì˜¬ì¸ì›í…Œí¬ ì´ë…¸ë² ì´í„°</p>
                        </div>
                    </div>
                    <div class="flex items-center gap-4">
                        <div id="userInfo" class="text-right">
                            <p class="text-sm text-blue-100">ë¡œê·¸ì¸: <span id="instructorName" class="font-semibold text-white"></span></p>
                            <p class="text-xs text-blue-200"><span id="instructorType"></span></p>
                        </div>
                        <button onclick="showMyPageModal()" class="bg-blue-500 hover:bg-blue-600 text-white px-4 py-2 rounded-lg font-semibold transition-all">
                            <i class="fas fa-user-circle mr-2"></i>MyPage
                        </button>
                        <button onclick="logout()" class="bg-white text-blue-600 hover:bg-blue-50 px-4 py-2 rounded-lg font-semibold transition-all">
                            <i class="fas fa-sign-out-alt mr-2"></i>ë¡œê·¸ì•„ì›ƒ
                        </button>
                    </div>
                </div>
            </div>
        </header>

        <!-- ë„¤ë¹„ê²Œì´ì…˜ íƒ­ (2ë‹¨ ë©”ë‰´) -->
        <nav class="bg-white shadow-md">
            <div class="container mx-auto px-4">
                <div class="flex space-x-1 border-b border-gray-200">
                    <!-- ëŒ€ì‹œë³´ë“œ -->
                    <button onclick="showTab('dashboard')" class="tab-btn px-4 py-3 text-sm font-semibold text-gray-700 hover:text-blue-600 hover:bg-blue-50 rounded-t bg-blue-50 text-blue-600" data-tab="dashboard">
                        <i class="fas fa-tachometer-alt mr-1"></i>ëŒ€ì‹œë³´ë“œ
                    </button>
                    
                    <!-- ì‹œìŠ¤í…œê´€ë¦¬ ë©”ë‰´ -->
                    <div class="relative group">
                        <button class="px-4 py-3 text-sm font-semibold text-gray-700 hover:text-blue-600 hover:bg-blue-50 rounded-t">
                            <i class="fas fa-cogs mr-1"></i>ì‹œìŠ¤í…œê´€ë¦¬
                            <i class="fas fa-chevron-down ml-1 text-xs"></i>
                        </button>
                        <div class="hidden group-hover:flex absolute left-0 top-full bg-white shadow-lg rounded-b z-10 w-[300px] flex-col">
                            <button onclick="showTab('instructor-codes')" class="tab-btn flex items-center w-full px-3 py-2 text-sm hover:bg-blue-50" data-tab="instructor-codes" style="justify-content: flex-start !important; text-align: left !important;">
                                <i class="fas fa-user-shield mr-2" style="width: 16px;"></i>ê°•ì‚¬ì½”ë“œ/ê¶Œí•œ
                            </button>
                            <button onclick="showTab('instructors')" class="tab-btn flex items-center w-full px-3 py-2 text-sm hover:bg-blue-50" data-tab="instructors" style="justify-content: flex-start !important; text-align: left !important;">
                                <i class="fas fa-user-tie mr-2" style="width: 16px;"></i>ê°•ì‚¬ê´€ë¦¬
                            </button>
                            <button onclick="showTab('system-settings')" class="tab-btn flex items-center w-full px-3 py-2 text-sm hover:bg-blue-50" data-tab="system-settings" style="justify-content: flex-start !important; text-align: left !important;">
                                <i class="fas fa-cog mr-2" style="width: 16px;"></i>ì‹œìŠ¤í…œ ë“±ë¡
                            </button>
                            <button onclick="showTab('notices')" class="tab-btn flex items-center w-full px-3 py-2 text-sm hover:bg-blue-50" data-tab="notices" style="justify-content: flex-start !important; text-align: left !important;">
                                <i class="fas fa-bullhorn mr-2" style="width: 16px;"></i>ê³µì§€ì‚¬í•­
                            </button>
                        </div>
                    </div>
                    
                    <!-- ê³¼ì • ë©”ë‰´ -->
                    <div class="relative group">
                        <button class="px-4 py-3 text-sm font-semibold text-gray-700 hover:text-blue-600 hover:bg-blue-50 rounded-t">
                            <i class="fas fa-graduation-cap mr-1"></i>ê³¼ì •
                            <i class="fas fa-chevron-down ml-1 text-xs"></i>
                        </button>
                        <div class="hidden group-hover:flex absolute left-0 top-full bg-white shadow-lg rounded-b z-10 w-[300px] flex-col">
                            <button onclick="showTab('subjects')" class="tab-btn flex items-center w-full px-3 py-2 text-sm hover:bg-blue-50" data-tab="subjects" style="justify-content: flex-start !important; text-align: left !important;">
                                <i class="fas fa-book mr-2" style="width: 16px;"></i>êµê³¼ëª©
                            </button>
                            <button onclick="showTab('holidays')" class="tab-btn flex items-center w-full px-3 py-2 text-sm hover:bg-blue-50" data-tab="holidays" style="justify-content: flex-start !important; text-align: left !important;">
                                <i class="fas fa-calendar-alt mr-2" style="width: 16px;"></i>ê³µíœ´ì¼
                            </button>
                            <button onclick="showTab('courses')" class="tab-btn flex items-center w-full px-3 py-2 text-sm hover:bg-blue-50" data-tab="courses" style="justify-content: flex-start !important; text-align: left !important;">
                                <i class="fas fa-school mr-2" style="width: 16px;"></i>ê³¼ì •ê´€ë¦¬
                            </button>
                        </div>
                    </div>
                    
                    <!-- í•™ìƒ ë©”ë‰´ -->
                    <div class="relative group">
                        <button class="px-4 py-3 text-sm font-semibold text-gray-700 hover:text-blue-600 hover:bg-blue-50 rounded-t">
                            <i class="fas fa-user-graduate mr-1"></i>í•™ìƒ
                            <i class="fas fa-chevron-down ml-1 text-xs"></i>
                        </button>
                        <div class="hidden group-hover:flex absolute left-0 top-full bg-white shadow-lg rounded-b z-10 w-[300px] flex-col">
                            <button onclick="showTab('students')" class="tab-btn flex items-center w-full px-3 py-2 text-sm hover:bg-blue-50 bg-blue-50 text-blue-600" data-tab="students" style="justify-content: flex-start !important; text-align: left !important;">
                                <i class="fas fa-users mr-2" style="width: 16px;"></i>í•™ìƒê´€ë¦¬
                            </button>
                            <button onclick="showTab('counselings')" class="tab-btn flex items-center w-full px-3 py-2 text-sm hover:bg-blue-50" data-tab="counselings" style="justify-content: flex-start !important; text-align: left !important;">
                                <i class="fas fa-comments mr-2" style="width: 16px;"></i>ìƒë‹´ê´€ë¦¬
                            </button>
                        </div>
                    </div>
                    
                    <!-- ê°•ì˜ ë©”ë‰´ -->
                    <div class="relative group">
                        <button class="px-4 py-3 text-sm font-semibold text-gray-700 hover:text-blue-600 hover:bg-blue-50 rounded-t">
                            <i class="fas fa-chalkboard mr-1"></i>ê°•ì˜
                            <i class="fas fa-chevron-down ml-1 text-xs"></i>
                        </button>
                        <div class="hidden group-hover:flex absolute left-0 top-full bg-white shadow-lg rounded-b z-10 w-[300px] flex-col">
                            <button onclick="showTab('timetables')" class="tab-btn flex items-center w-full px-3 py-2 text-sm hover:bg-blue-50" data-tab="timetables" style="justify-content: flex-start !important; text-align: left !important;">
                                <i class="fas fa-clock mr-2" style="width: 16px;"></i>ì‹œê°„í‘œ
                            </button>
                            <button onclick="showTab('training-logs')" class="tab-btn flex items-center w-full px-3 py-2 text-sm hover:bg-blue-50" data-tab="training-logs" style="justify-content: flex-start !important; text-align: left !important;">
                                <i class="fas fa-clipboard-list mr-2" style="width: 16px;"></i>í›ˆë ¨ì¼ì§€ ê´€ë¦¬
                            </button>
                        </div>
                    </div>
                    
                    <!-- AI ë©”ë‰´ -->
                    <div class="relative group">
                        <button class="px-4 py-3 text-sm font-semibold text-gray-700 hover:text-blue-600 hover:bg-blue-50 rounded-t">
                            <i class="fas fa-robot mr-1"></i>AI
                            <i class="fas fa-chevron-down ml-1 text-xs"></i>
                        </button>
                        <div class="hidden group-hover:flex absolute left-0 top-full bg-white shadow-lg rounded-b z-10 w-[300px] flex-col">
                            <button onclick="showTab('class-notes')" class="tab-btn flex items-center w-full px-3 py-2 text-sm hover:bg-blue-50" data-tab="class-notes" style="justify-content: flex-start !important; text-align: left !important;">
                                <i class="fas fa-book-open mr-2" style="width: 16px;"></i>SSIRNë©”ëª¨ì¥(ìˆ˜ì—…,ê¸°ì–µ,ì •ë³´,etc)
                            </button>
                            <button onclick="showTab('ai-report')" class="tab-btn flex items-center w-full px-3 py-2 text-sm hover:bg-blue-50" data-tab="ai-report" style="justify-content: flex-start !important; text-align: left !important;">
                                <i class="fas fa-file-alt mr-2" style="width: 16px;"></i>AI ìƒê¸°ë¶€
                            </button>
                            <button onclick="showTab('ai-training-log')" class="tab-btn flex items-center w-full px-3 py-2 text-sm hover:bg-blue-50" data-tab="ai-training-log" style="justify-content: flex-start !important; text-align: left !important;">
                                <i class="fas fa-brain mr-2" style="width: 16px;"></i>AI í›ˆë ¨ì¼ì§€
                            </button>
                            <button onclick="showTab('ai-counseling')" class="tab-btn flex items-center w-full px-3 py-2 text-sm hover:bg-blue-50" data-tab="ai-counseling" style="justify-content: flex-start !important; text-align: left !important;">
                                <i class="fas fa-comments mr-2" style="width: 16px;"></i>AI ìƒë‹´ì¼ì§€
                            </button>
                        </div>
                    </div>
                    
                    <!-- íŒ€ ë©”ë‰´ (ë“œë¡­ë‹¤ìš´) -->
                    <div class="relative group">
                        <button class="px-4 py-3 text-sm font-semibold text-gray-700 hover:text-blue-600 hover:bg-blue-50 rounded-t">
                            <i class="fas fa-users mr-1"></i>íŒ€
                            <i class="fas fa-chevron-down ml-1 text-xs"></i>
                        </button>
                        <div class="hidden group-hover:flex absolute left-0 top-full bg-white shadow-lg rounded-b z-10 w-[300px] flex-col">
                            <button onclick="showTab('projects')" class="tab-btn flex items-center w-full px-3 py-2 text-sm hover:bg-blue-50" data-tab="projects" style="justify-content: flex-start !important; text-align: left !important;">
                                <i class="fas fa-users mr-2" style="width: 16px;"></i>íŒ€ ê´€ë¦¬
                            </button>
                            <button onclick="showTab('team-activity-logs')" class="tab-btn flex items-center w-full px-3 py-2 text-sm hover:bg-blue-50" data-tab="team-activity-logs" style="justify-content: flex-start !important; text-align: left !important;">
                                <i class="fas fa-clipboard-list mr-2" style="width: 16px;"></i>íŒ€ í™œë™ì¼ì§€
                            </button>
                        </div>
                    </div>

                </div>
            </div>
        </nav>

        <!-- ë©”ì¸ ì½˜í…ì¸  -->
        <main class="container mx-auto px-4 py-8">
            <div id="app">
                <div class="text-center py-8">
                    <i class="fas fa-spinner fa-spin text-4xl text-blue-600"></i>
                    <p class="text-gray-600 mt-4">ë¡œë”© ì¤‘...</p>
                </div>
            </div>
            
            <!-- ê³¼ì • ì¶”ê°€/ìˆ˜ì • í¼ (ëª¨ë‹¬) -->
            <div id="course-form" class="hidden fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50">
                <div class="bg-white rounded-lg shadow-xl p-6 max-w-4xl w-full max-h-[90vh] overflow-y-auto">
                    <!-- í¼ ë‚´ìš©ì€ JavaScriptì—ì„œ ë™ì  ìƒì„± -->
                </div>
            </div>
            
            <!-- êµê³¼ëª© ì„ íƒ ëª¨ë‹¬ -->
            <div id="subject-selector" class="hidden fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50">
                <div class="bg-white rounded-lg shadow-xl p-6 max-w-4xl w-full max-h-[90vh] overflow-y-auto">
                    <!-- ë‚´ìš©ì€ JavaScriptì—ì„œ ë™ì  ìƒì„± -->
                </div>
            </div>
            
            <!-- ì»¤ìŠ¤í…€ ì•Œë¦¼ ëª¨ë‹¬ -->
            <div id="custom-alert" class="hidden fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-[60]">
                <div class="alert-box bg-green-50 border border-green-200 rounded-lg shadow-xl p-6 max-w-md w-full mx-4">
                    <div class="flex items-start gap-4">
                        <div class="alert-icon flex-shrink-0">
                            <i class="fas fa-check-circle text-green-600 text-2xl"></i>
                        </div>
                        <div class="flex-1">
                            <p id="alert-message" class="text-green-800 text-lg font-medium"></p>
                        </div>
                    </div>
                    <div class="flex justify-end mt-4">
                        <button onclick="window.hideAlert()" class="bg-blue-600 hover:bg-blue-700 text-white px-6 py-2 rounded transition-colors">
                            í™•ì¸
                        </button>
                    </div>
                </div>
            </div>
            
            <!-- ì»¤ìŠ¤í…€ í™•ì¸ ëª¨ë‹¬ -->
            <div id="custom-confirm" class="hidden fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-[60]">
                <div class="bg-white rounded-lg shadow-xl p-6 max-w-md w-full mx-4">
                    <p id="confirm-message" class="text-gray-800 mb-4 whitespace-pre-line"></p>
                    <div class="flex justify-end space-x-2">
                        <button onclick="window.handleConfirm(false)" class="bg-gray-300 hover:bg-gray-400 text-gray-800 px-6 py-2 rounded">
                            ì·¨ì†Œ
                        </button>
                        <button onclick="window.handleConfirm(true)" class="bg-blue-600 hover:bg-blue-700 text-white px-6 py-2 rounded">
                            í™•ì¸
                        </button>
                    </div>
                </div>
            </div>
            
            <!-- ë¡œë”© ì˜¤ë²„ë ˆì´ -->
            <div id="loading-overlay" class="hidden fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-[70]">
                <div class="bg-white rounded-lg shadow-xl p-8 max-w-md w-full mx-4">
                    <div class="text-center">
                        <div class="mb-4">
                            <i class="fas fa-spinner fa-spin text-5xl text-blue-600"></i>
                        </div>
                        <h3 class="text-xl font-semibold text-gray-800 mb-2">ë°ì´í„° ë¡œë”© ì¤‘</h3>
                        <p class="text-gray-600 mb-4">ì ì‹œë§Œ ê¸°ë‹¤ë ¤ì£¼ì„¸ìš”...</p>
                        
                        <!-- í”„ë¡œê·¸ë ˆìŠ¤ ë°” -->
                        <div class="w-full bg-gray-200 rounded-full h-2.5 mb-2">
                            <div id="loading-progress" class="bg-blue-600 h-2.5 rounded-full transition-all duration-300" style="width: 0%"></div>
                        </div>
                        <p id="loading-message" class="text-sm text-gray-500">ë°ì´í„°ë¥¼ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘...</p>
                    </div>
                </div>
            </div>

            <!-- í•™ìƒ ìƒì„¸ë³´ê¸° ëª¨ë‹¬ -->
            <div id="student-detail" class="hidden"></div>
            
            <!-- ì˜ˆìœ ì•Œë¦¼ ëª¨ë‹¬ -->
            <div id="alert-modal" class="hidden fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-[9999]">
                <div class="bg-white rounded-2xl shadow-2xl max-w-md w-full mx-4 transform transition-all">
                    <div id="alert-header" class="p-6 rounded-t-2xl">
                        <div class="flex items-center gap-4">
                            <div id="alert-icon" class="text-4xl"></div>
                            <h3 id="alert-title" class="text-xl font-bold text-white"></h3>
                        </div>
                    </div>
                    <div class="p-6">
                        <p id="alert-message" class="text-gray-700 text-lg leading-relaxed whitespace-pre-line"></p>
                    </div>
                    <div class="p-6 pt-0 flex justify-end gap-3">
                        <button id="alert-cancel-btn" class="hidden px-6 py-2.5 bg-gray-200 hover:bg-gray-300 text-gray-800 rounded-lg font-semibold transition-colors">
                            ì·¨ì†Œ
                        </button>
                        <button id="alert-confirm-btn" class="px-6 py-2.5 bg-blue-600 hover:bg-blue-700 text-white rounded-lg font-semibold transition-colors">
                            í™•ì¸
                        </button>
                    </div>
                </div>
            </div>
        </main>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/axios@1.6.0/dist/axios.min.js"></script>
    
    <!-- ì™„ì „ ìºì‹œ ì œê±° (ë¡œê·¸ì¸ ì •ë³´ëŠ” ìœ ì§€) -->
    <script>
        // ì„œë¹„ìŠ¤ ì›Œì»¤ ì™„ì „ ì œê±°
        if ('serviceWorker' in navigator) {
            navigator.serviceWorker.getRegistrations().then(function(registrations) {
                for(let registration of registrations) {
                    registration.unregister();
                }
            });
        }
        
        // ëª¨ë“  ìºì‹œ ìŠ¤í† ë¦¬ì§€ ì‚­ì œ
        if ('caches' in window) {
            caches.keys().then(function(names) {
                for (let name of names) {
                    caches.delete(name);
                }
            });
        }
        
        // ìºì‹œë§Œ ì‚­ì œ (ë¡œê·¸ì¸ ì •ë³´ëŠ” ìœ ì§€)
        const keysToRemove = [];
        for (let i = 0; i < localStorage.length; i++) {
            const key = localStorage.key(i);
            if (key && key.startsWith('cache_')) {
                keysToRemove.push(key);
            }
        }
        keysToRemove.forEach(key => localStorage.removeItem(key));
    </script>
    
    <!-- ìºì‹œ ë²„ìŠ¤íŒ…ì„ ìœ„í•œ ë²„ì „ ì¿¼ë¦¬ -->
    <script src="/app.js?v=2.0.25"></script>
    
    <!-- PWA Service Worker Registration -->
    <script>
        // Service Worker ì™„ì „ ë¹„í™œì„±í™”
        if ('serviceWorker' in navigator) {
            navigator.serviceWorker.getRegistrations().then(function(registrations) {
                for(let registration of registrations) {
                    registration.unregister();
                    console.log('Service Worker unregistered');
                }
            });
        }
        
        // ì•„ë˜ ì½”ë“œëŠ” ì‹¤í–‰ë˜ì§€ ì•ŠìŒ
        if (false) {
            window.addEventListener('load', () => {
                navigator.serviceWorker.register('/service-worker.js')
                    .then((registration) => {
                        console.log('âœ… Service Worker registered successfully:', registration.scope);
                        
                        // ì—…ë°ì´íŠ¸ í™•ì¸
                        registration.addEventListener('updatefound', () => {
                            const newWorker = registration.installing;
                            newWorker.addEventListener('statechange', () => {
                                if (newWorker.state === 'installed' && navigator.serviceWorker.controller) {
                                    // ìƒˆ ë²„ì „ ì‚¬ìš© ê°€ëŠ¥
                                    if (confirm('ìƒˆë¡œìš´ ë²„ì „ì´ ìˆìŠµë‹ˆë‹¤. ì§€ê¸ˆ ì—…ë°ì´íŠ¸í•˜ì‹œê² ìŠµë‹ˆê¹Œ?')) {
                                        window.location.reload();
                                    }
                                }
                            });
                        });
                    })
                    .catch((error) => {
                        console.error('âŒ Service Worker registration failed:', error);
                    });
            });
        }
        
        // PWA ì„¤ì¹˜ í”„ë¡¬í”„íŠ¸
        let deferredPrompt;
        
        window.addEventListener('beforeinstallprompt', (e) => {
            e.preventDefault();
            deferredPrompt = e;
            
            // ì„¤ì¹˜ ë°°ë„ˆ í‘œì‹œ (ì„ íƒì‚¬í•­)
            showInstallBanner();
        });
        
        function showInstallBanner() {
            // ì´ë¯¸ ì„¤ì¹˜ë˜ì–´ ìˆìœ¼ë©´ í‘œì‹œí•˜ì§€ ì•ŠìŒ
            if (window.matchMedia('(display-mode: standalone)').matches) {
                return;
            }
            
            // ë°°ë„ˆ ìƒì„±
            const banner = document.createElement('div');
            banner.id = 'install-banner';
            banner.className = 'fixed bottom-0 left-0 right-0 bg-blue-600 text-white p-4 shadow-lg z-50 transform transition-transform';
            banner.innerHTML = `
                <div class="container mx-auto flex items-center justify-between">
                    <div class="flex items-center gap-3">
                        <i class="fas fa-mobile-alt text-2xl"></i>
                        <div>
                            <p class="font-semibold">ì•±ìœ¼ë¡œ ì„¤ì¹˜í•˜ê¸°</p>
                            <p class="text-sm text-blue-100">í™ˆ í™”ë©´ì— ì¶”ê°€í•˜ì—¬ ë” ë¹ ë¥´ê²Œ ì‚¬ìš©í•˜ì„¸ìš”</p>
                        </div>
                    </div>
                    <div class="flex gap-2">
                        <button onclick="installApp()" class="bg-white text-blue-600 px-4 py-2 rounded font-semibold hover:bg-blue-50">
                            ì„¤ì¹˜
                        </button>
                        <button onclick="dismissInstallBanner()" class="text-white hover:text-blue-100">
                            <i class="fas fa-times text-xl"></i>
                        </button>
                    </div>
                </div>
            `;
            document.body.appendChild(banner);
            
            // 3ì¼ í›„ ë‹¤ì‹œ í‘œì‹œí•˜ë„ë¡ ì„¤ì •
            const dismissed = localStorage.getItem('install-banner-dismissed');
            if (dismissed && Date.now() - parseInt(dismissed) < 3 * 24 * 60 * 60 * 1000) {
                banner.remove();
            }
        }
        
        async function installApp() {
            if (!deferredPrompt) {
                return;
            }
            
            deferredPrompt.prompt();
            const { outcome } = await deferredPrompt.userChoice;
            
            console.log(`User response to install prompt: ${outcome}`);
            
            deferredPrompt = null;
            dismissInstallBanner();
        }
        
        function dismissInstallBanner() {
            const banner = document.getElementById('install-banner');
            if (banner) {
                banner.remove();
                localStorage.setItem('install-banner-dismissed', Date.now().toString());
            }
        }
        
        // PWA ëª¨ë“œ ê°ì§€
        if (window.matchMedia('(display-mode: standalone)').matches || window.navigator.standalone === true) {
            console.log('âœ… Running as PWA (standalone mode)');
            // PWA ëª¨ë“œì—ì„œë§Œ ì‹¤í–‰í•  ì½”ë“œ
            document.body.classList.add('pwa-mode');
        }
    </script>
    
    <!-- í™”ë©´ë³´í˜¸ê¸° ì˜¤ë²„ë ˆì´ (ìë™ ìƒˆë¡œê³ ì¹¨ ì‹œ í‘œì‹œ) -->
    <div id="screensaver" class="screensaver hidden">
        <div class="screensaver-blur"></div>
        <div class="screensaver-logo">
            <img src="/woosong-logo.png" alt="Logo" class="logo-floating">
            <p class="text-white text-lg font-semibold mt-4 text-center animate-pulse">ë°ì´í„° ìƒˆë¡œê³ ì¹¨ ì¤‘...</p>
        </div>
    </div>
    
    <style>
        /* í™”ë©´ë³´í˜¸ê¸° ì˜¤ë²„ë ˆì´ */
        .screensaver {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: 9999;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .screensaver.hidden {
            display: none !important;
        }
        
        /* íë¦¼ ë°°ê²½ */
        .screensaver-blur {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            backdrop-filter: blur(10px);
            background: rgba(0, 0, 0, 0.3);
        }
        
        /* ë– ë‹¤ë‹ˆëŠ” ë¡œê³  ì»¨í…Œì´ë„ˆ */
        .screensaver-logo {
            position: relative;
            z-index: 10000;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
        }
        
        /* ë– ë‹¤ë‹ˆëŠ” ë¡œê³  ì• ë‹ˆë©”ì´ì…˜ */
        .logo-floating {
            width: 150px;
            height: 150px;
            object-fit: contain;
            animation: float 4s ease-in-out infinite, bounce 2s ease-in-out infinite;
            filter: drop-shadow(0 10px 20px rgba(0, 0, 0, 0.3));
        }
        
        /* ë– ë‹¤ë‹ˆëŠ” ì• ë‹ˆë©”ì´ì…˜ (ì¢Œìš°ìƒí•˜ ì´ë™) */
        @keyframes float {
            0%, 100% {
                transform: translate(0, 0) rotate(0deg);
            }
            25% {
                transform: translate(30px, -30px) rotate(5deg);
            }
            50% {
                transform: translate(-20px, 20px) rotate(-5deg);
            }
            75% {
                transform: translate(40px, 10px) rotate(3deg);
            }
        }
        
        /* ë°”ìš´ìŠ¤ íš¨ê³¼ (ìœ„ì•„ë˜ ì›€ì§ì„) */
        @keyframes bounce {
            0%, 100% {
                transform: translateY(0) scale(1);
            }
            50% {
                transform: translateY(-20px) scale(1.05);
            }
        }
    </style>
</body>
</html>
